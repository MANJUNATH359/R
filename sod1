import pandas as pd

input_file = 'sod1_dbsnp_data.txt'  # Change this to your actual file name
output_file = 'sod1_filtered_maf_gt_0.001.txt'
maf_column = 'MAF'  # Make sure this matches your column name exactly

# Load the tab-delimited file
try:
    df = pd.read_csv(input_file, delimiter='\t')
    print("File loaded successfully.")
except Exception as e:
    print(f"Error loading file: {e}")
    exit()

print("Columns detected:", df.columns.tolist())

# Check if MAF column exists
if maf_column not in df.columns:
    print(f"Column '{maf_column}' not found in file. Please check the column names.")
    exit()

# Convert MAF column to numeric, coerce errors to NaN
df[maf_column] = pd.to_numeric(df[maf_column], errors='coerce')

# Filter rows where MAF > 0.001
filtered_df = df[df[maf_column] > 0.001]

# Save filtered results to a new tab-delimited file
filtered_df.to_csv(output_file, sep='\t', index=False)

print(f"Filtered data saved to: {output_file}")
